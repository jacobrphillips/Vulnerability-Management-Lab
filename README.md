![banner](vullab.png)
# Vulnerability Management Lab with Azure VM and Nessus Essentials

This repository contains instructions for setting up a Vulnerability Management Lab using Azure VM as a honeypot and Nessus Essentials for vulnerability scanning. The lab is designed to demonstrate the importance of vulnerability management and the effectiveness of using tools like Nessus to identify and mitigate security risks.

## Prerequisites

Before getting started, ensure you have the following:

- An Azure account ([Sign up here](https://azure.microsoft.com/en-us/free))
  - If you're a student, you can use the [Azure for Students](https://azure.microsoft.com/en-gb/free/students) program.
    
- Nessus Essentials account ([Sign up here](https://www.tenable.com/products/nessus/nessus-essentials))

## Setup Instructions

### Step 1: Create a Vulnerable VM (Honeypot) in Azure

**Purpose:** Establish a virtual machine to serve as the honeypot for simulating real-world attack scenarios.

 - I've made a step-by-step guide on how to set up a Honeypot in Azure here: [Setting Up Vulnerable VMs in Azure](https://github.com/jacobrphillips/Azure-VM-Honeypot/blob/main/README.md)

### Step 2: Configure Initial Scan Settings and Run Your First Scan

**Purpose:** Identify baseline vulnerabilities within the VM environment.

1. After logging into your Nessus Essentials Account, you'll land on the My Scans dashboard.
     - Click the New Scan button at the top left of the dashboard

    ![VM-2](Empty-MyScans.png)
   
2. In the Scan Template, under Vulnerabilities, choose Basic Network Scan.

    ![VM-2](ScanTemplates.png)
   
3. Configure the Settings & Run Your First Scan
     - Name: Whatever you'd like your scan to be called
     - Description: You can put a brief description behind the reason for the scan
     - Folder: A place where you can store your scans
     - Targets: Put the Public IP Address of your VM you created in the first step
     - Click Save, and Run your scan

      ![VM-2](FirstScan-Config.png)

      ![VM-2](MyScans.png)

5. Review initial Scan results
     - You can view the General Scan Details along with more specfic details by clicking the Vulnerabilites tab
  
     ![VM-2](FirstScan-1.png)

     ![VM-2](FirstScan-2.png)

     ![VM-2](FirstScan-3.png)
   

### Step 3: Configure VM for Further Vulnerabilities

**Purpose:** Introduce additional vulnerabilities to assess the effectiveness of authenticated scanning.

1. Enable Remote Registry Service
    - RDP into your VM and in the search bar type Services.msc
    - Find the Remote Registry Service
		    - This service essentially allows remote users to modify registry settings on this VM
    
    ![VM-2](Services-RemoteRegistry-1.png)   

    - Right click Registry Service and select Properties
      
    ![VM-2](Services-RemoteRegistry-2.png)  

    - Set the Start Up Type to Automatic to enable the service
      - Click Apply, then OK

    ![VM-2](Services-RemoteRegistry-3.png)  

2. Verify File and Printer sharing is turned on
    - In the search bar, search Control Panel
    - Click on the Network and Internet link

    ![VM-2](ControlPanel.png)   

    - Next, click the Network and Sharing Center

    ![VM-2](NetworkAndSharingCenter.png)   

    - Finally, click the Change advanced sharing settings

    ![VM-2](BasicNetworkInfo.png)

    ![VM-2](Advanced%20sharing%20settings.png)   

    - In this menu, verify that Turn on file and printer sharing is on underneath the Private tab

4. Turn User Account Control off
    - In the search bar, type user account control
    - Turn it all the way down, as we are not in the same domain in order to scan it
  
      ![VM-2](User%20Account%20Control%20Settings.png)

  
5. Add a policy to the Registry
   - In the search bar, type Registry Editor

     ![VM-2](RegistryEditor-1.png)

   - Follow this file structure:
       - HKEY_LOCAL_MACHINE > SOFTWARE > Micrsoft > Windows > CurrentVersion > Policies > System
    
     ![VM-2](RegistryEditor-2.png)

   - In here, make a new DWORD called LocalAccountTokenFilterPolicy

     ![VM-2](RegistryEditor-4.png)
     
     ![VM-2](RegistryEditor-3.png)

   - Once made, right click and set its value to 1

     ![VM-2](RegistryEditor-5.png)

     ![VM-2](RegistryEditor-6.png)

   - Once updated, restart the VM

### Step 4: Add Credentials in Nessus

**Purpose:** Enhance scan accuracy by providing Nessus with valid credentials for authenticated scanning.

1. In Nessus dashboard, go back to My Scans, click the existing scan, then click the More dropdown > Configure
   
   ![VM-2](ConfigureDropDown.png)
   
2. Once here, click the Credentials tab > Windows
 
   ![VM-2](CredentialMenu.png)
   
5. Enter the VM Login credentials established with the VM's creation in Azure, then Save and Go back to My Scans
   - This allows Nessus to access more areas of the VM, providing deeper insight into potential vulnerabilities.

   ![VM-2](AddCredentials.png)

### Step 4: Run Scan Again

**Purpose:** Conduct a comprehensive vulnerability scan with authenticated access to identify additional security issues.

1. Run the scan again using Nessus with the added credentials.

### Step 5: Analyze New Report

**Purpose:** Evaluate the findings of the latest vulnerability scan to identify any new security issues and assess the effectiveness of remediation efforts.

1. Navigate to the scan results for the most recent scan you performed.

  ![VM-2](SecondScan-1.png)
   
2. Review the report summary to identify any new vulnerabilities detected since the last scan.

  ![VM-2](SecondScan-2.png)
   
3. Pay attention to the severity levels of the vulnerabilities and prioritize addressing critical issues first.

  ![VM-2](High-Vulnerabilities.png)
   
4. Compare the current scan results with previous ones to track the progress of vulnerability remediation efforts over time.
   
5. Take note of any recurring or persistent vulnerabilities that may require additional attention or alternative mitigation strategies.
   
6. Analyze any trends or patterns in the vulnerability data to enhance future security measures and risk management strategies.
    - By thoroughly analyzing the new vulnerability report, you can gain valuable insights into the security posture of your environment and make informed decisions to strengthen your defenses against potential threats.


### Step 6: View Remediation Tab in Nessus Scan

**Purpose:** Access recommendations for addressing identified vulnerabilities.

1. In the report, locate and click on the "Remediation" tab.
   
2. Here, you will find recommendations and guidance on how to mitigate each identified vulnerability.

     ![Nessus Remediation Tab](Remedations-List.png)
   
3. Review the remediation steps provided and implement them to improve the security posture of your systems.

After Remediation:

  ![VM-2](After-Remedation.png)

## Conclusion

This Vulnerability Management Lab demonstrates the importance of implementing proper security measures and regularly scanning for vulnerabilities. By using tools like Nessus Essentials and leveraging cloud infrastructure like Azure VMs, organizations can effectively manage and mitigate security risks.
